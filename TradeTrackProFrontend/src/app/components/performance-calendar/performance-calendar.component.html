<div class="bg-[#0f1a2b] border border-slate-800 rounded-2xl p-6 shadow-xl">

    <!-- Header -->
    <div class="flex items-center justify-between mb-6">
        <button (click)="prevMonth()"
            class="px-3 py-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors text-sm font-medium">
            &laquo; Prev Month
        </button>

        <h2 class="text-xl font-bold text-white tracking-wide">{{ currentMonthYear }}</h2>

        <button (click)="nextMonth()"
            class="px-3 py-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors text-sm font-medium">
            Next Month &raquo;
        </button>
    </div>

    <!-- Calendar Grid -->
    <div class="grid grid-cols-7 gap-2 mb-2">
        <!-- Weekday Headers -->
        <div *ngFor="let day of weekDays"
            class="text-center text-xs font-semibold text-slate-500 uppercase tracking-wider py-2">
            {{ day }}
        </div>
    </div>

    <div class="grid grid-cols-7 gap-2">
        <!-- Days -->
        <div *ngFor="let day of calendarDays" (click)="onDateClick(day)" [ngClass]="getDayClass(day)"
            class="group relative h-24 rounded-xl border border-white/5 p-2 transition-all duration-200 hover:scale-[1.02] cursor-pointer flex flex-col justify-between overflow-hidden">

            <!-- Date Number -->
            <span class="text-xs font-medium opacity-50">{{ day.dayNum }}</span>

            <!-- Content (if trade exists) -->
            <div *ngIf="day.hasTrade" class="flex flex-col items-end">
                <span class="font-bold text-sm tracking-tight">
                    {{ day.pnl | currency:'USD':'symbol':'1.0-0' }}
                </span>
                <div class="flex gap-1 mt-1 text-[10px] font-medium opacity-80">
                    <span *ngIf="day.wins" class="text-emerald-300">{{ day.wins }}W</span>
                    <span *ngIf="day.losses" class="text-red-300">{{ day.losses }}L</span>
                </div>
            </div>

            <!-- Tooltip -->
            <div *ngIf="day.hasTrade"
                class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-32 bg-slate-900 border border-slate-700 text-white text-xs rounded-lg p-2 shadow-xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10">
                <div class="text-center font-bold mb-1">{{ day.date | date:'mediumDate' }}</div>
                <div class="flex justify-between px-1">
                    <span class="text-slate-400">Net P/L:</span>
                    <span [class.text-emerald-400]="day.pnl! > 0" [class.text-red-400]="day.pnl! < 0">
                        {{ day.pnl | currency }}
                    </span>
                </div>
                <div class="flex justify-between px-1 mt-1">
                    <span class="text-slate-400">Trades:</span>
                    <span>{{ (day.wins || 0) + (day.losses || 0) }}</span>
                </div>
            </div>

        </div>
    </div>

    <!-- Loading Overlay -->
    <div *ngIf="loading"
        class="absolute inset-0 bg-[#0f1a2b]/80 backdrop-blur-sm flex items-center justify-center rounded-2xl z-20">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"></div>
    </div>
</div>